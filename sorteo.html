<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Detalle del Sorteo | Gana con Narbis</title>
    
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="site-header">
        <div class="header-main">
            <div class="container">
                <div class="header-content">
                    <div class="logo-section">
                        <a href="index.html" class="logo-link">
                            <div class="logo-container">
                                <img src="logonarbis.jpeg" alt="Logo" class="logo-img">
                            </div>
                            <div class="logo-text">
                                <h1>NARBIS</h1>
                                <p>Sorteos Exclusivos</p>
                            </div>
                        </a>
                    </div>
                    <div class="header-actions">
                        <a href="index.html" class="btn-check-tickets" style="text-decoration:none;">
                            <i class="fas fa-home"></i> Volver al Inicio
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="detail-view show" style="display: block; margin-top: 20px;">
        <div class="detail-view-wrapper">
            
            <header class="header" style="position: relative; top: 0;">
                <div class="header-content">
                    <button class="back-button" onclick="window.location.href='index.html'">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h1 class="header-title">Detalle del Sorteo</h1>
                    <button class="share-button" onclick="compartirSorteo()">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            </header>

            <div id="sorteo-detalle-content">
                <div class="gallery">
                    <div class="gallery-scroll">
                        <img src="" id="imagen-sorteo" class="gallery-image" alt="Premio">
                    </div>
                </div>

                <div class="detail-container">
                    <div class="prize-section">
                        <div class="prize-date">
                            <span>üóìÔ∏è</span>
                            <span id="fecha-sorteo">Cargando...</span>
                        </div>
                        <h2 class="prize-title" id="titulo-sorteo">Cargando t√≠tulo...</h2>
                        <div class="prize-price">Bs. <span id="precio-boleto-display">-</span> por boleto</div>
                        
                        <div class="raffle-description" id="descripcion-sorteo">
                        </div>

                        <div class="progress-section">
                            <div class="progress-header">
                                <span class="progress-title">Esta es tu oportunidad</span>
                                <span class="progress-percentage" id="porcentaje-progreso">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="barra-progreso" style="width: 0%"></div>
                            </div>
                            <div class="progress-text" id="texto-progreso">Calculando boletos restantes...</div>
                        </div>
                    </div>

                    <div class="quick-buy-section">
                        <h3 class="section-title">Compra aqu√≠ tus boletos</h3>
                        
                        <div class="quick-buy-grid">
                            <button class="quick-buy-btn buy-option-btn" data-tickets="2">+2</button>
                            <button class="quick-buy-btn popular buy-option-btn" data-tickets="5">
                                <span class="popular-tag">M√°s popular</span>
                                +5
                            </button>
                            <button class="quick-buy-btn buy-option-btn" data-tickets="10">+10</button>
                            <button class="quick-buy-btn buy-option-btn" data-tickets="20">+20</button>
                            <button class="quick-buy-btn buy-option-btn" data-tickets="50">+50</button>
                            <button class="quick-buy-btn buy-option-btn" data-tickets="100">+100</button>
                        </div>

                        <div class="custom-amount">
                            <button class="amount-control" id="decrement-btn">‚àí</button>
                            <input type="number" id="tickets-input" value="1" min="1" style="display:none;">
                            <div class="amount-display" id="tickets-count-display">1</div>
                            <button class="amount-control" id="increment-btn">+</button>
                        </div>
                        
                        <div style="margin-top: 15px; text-align: center; font-size: 1.2rem;">
                            Total a pagar: <span id="total-a-pagar" style="font-weight: 800; color: var(--primary);">Bs. 0.00</span>
                        </div>

                        <button class="buy-button" id="btn-comprar-boletos">
                            <i class="fas fa-shopping-cart"></i> Comprar boletos
                        </button>
                    </div>

                    <div class="details-section">
                        <h3 class="details-title">Informaci√≥n Legal</h3>
                        <div class="info-notice">
                            <span class="info-icon">üîí</span>
                            <div class="info-text">Sorteo verificado y seguro. Los resultados se publicar√°n en nuestras redes sociales.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="modal-datos-contacto">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Tus Datos</h2>
                <button class="modal-close" id="close-datos-contacto">√ó</button>
            </div>
            <div class="modal-body">
                <form id="form-datos-contacto" class="auth-form">
                    <div class="form-group">
                        <label>Nombre Completo</label>
                        <input type="text" id="nombre-completo" required placeholder="Ej: Juan P√©rez">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email-contacto" required placeholder="juan@correo.com">
                    </div>
                    <div class="form-group">
                        <label>Tel√©fono</label>
                        <input type="tel" id="telefono-contacto" required placeholder="0414 123 4567">
                    </div>
                    <div class="form-group">
                        <label>Estado</label>
                        <select id="estado-contacto" required style="width:100%; padding:15px; border-radius:12px; border:2px solid #e5e7eb;">
                            <option value="">Selecciona tu estado</option>
                            <option value="Distrito Capital">Distrito Capital</option>
                            <option value="Miranda">Miranda</option>
                            <option value="Zulia">Zulia</option>
                            <option value="Carabobo">Carabobo</option>
                            <option value="Lara">Lara</option>
                            <option value="Aragua">Aragua</option>
                            <option value="Anzo√°tegui">Anzo√°tegui</option>
                            <option value="Bol√≠var">Bol√≠var</option>
                            <option value="T√°chira">T√°chira</option>
                            <option value="Otros">Otros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>C√©dula</label>
                        <div class="id-input-group">
                            <select id="cedula-prefijo" class="id-type-select">
                                <option value="V">V</option>
                                <option value="E">E</option>
                            </select>
                            <input type="number" id="cedula-numero" class="id-number-input" required placeholder="12345678">
                        </div>
                    </div>
                    
                    <button type="submit" class="buy-button" style="margin-top:20px;">Continuar al Pago</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" id="modal-datos-pago">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Realizar Pago M√≥vil</h2>
                <button class="modal-close" id="close-datos-pago">√ó</button>
            </div>
            <div class="modal-body">
                <div class="payment-details">
                    <div class="payment-timer">
                        Referencia de Orden: <span id="codigo-referencia-display" style="font-weight:800; font-size:1.2em;">-</span>
                    </div>
                    
                    <p style="text-align:center; margin-bottom:15px;">Realiza el pago m√≥vil a los siguientes datos:</p>
                    
                    <div class="info-notice" style="flex-direction: column; align-items: flex-start; gap: 10px;">
                        <div class="payment-info-compact">
                            <span>Banco:</span> <strong>Banesco (0134)</strong>
                        </div>
                        <div class="payment-info-compact">
                            <span>Tel√©fono:</span> 
                            <strong>0412 123 4567</strong> 
                            <button class="copy-button" data-copy-target="04121234567"><i class="fas fa-copy"></i></button>
                        </div>
                        <div class="payment-info-compact">
                            <span>C√©dula:</span> 
                            <strong>V-12.345.678</strong>
                            <button class="copy-button" data-copy-target="12345678"><i class="fas fa-copy"></i></button>
                        </div>
                        <div class="payment-info-compact" style="border-top:1px solid #ddd; padding-top:10px; margin-top:5px; width:100%">
                            <span>Monto Exacto:</span> 
                            <strong style="color:var(--primary); font-size:1.2em;">Bs. <span id="monto-final-pago">0.00</span></strong>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="buy-button" id="abrir-reporte">Ya realic√© el pago</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="modal-reporte-pago">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Reportar Pago</h2>
                <button class="modal-close" id="close-reporte-pago">√ó</button>
            </div>
            <div class="modal-body">
                <form id="form-reporte-pago" class="auth-form">
                    <p style="text-align: center; margin-bottom: 20px;">Orden #<span id="codigo-referencia"></span></p>

                    <div class="form-group">
                        <label>N√∫mero de Referencia (6 √∫ltimos d√≠gitos)</label>
                        <input type="text" id="referencia-pago" required placeholder="Ej: 123456" minlength="6" maxlength="20">
                    </div>
                    
                    <div class="form-group">
                        <label>Tel√©fono desde el que pagaste</label>
                        <input type="tel" id="telefono-pago-movil" required placeholder="0412...">
                    </div>

                    <div class="form-group">
                        <label>Subir Capture <span style="color:red; font-weight:bold; font-size:0.9em;">* (Obligatorio)</span></label>
                        <input type="file" id="capture-input" accept="image/*" style="padding: 10px; border: 1px solid #ddd; border-radius: 8px; width: 100%;" required>
                    </div>

                    <button type="submit" class="buy-button">Reportar Pago</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="sorteo_script.js"></script> 

</body>
</html>
